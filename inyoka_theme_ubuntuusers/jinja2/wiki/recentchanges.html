{#
    wiki/recentchanges.html
    ~~~~~~~~~~~~~~~~~~~~~~~

    This template shows recent changes of articles in the entire wiki. This template
    uses no pagination and is limited via setting.py.

    :copyright: (c) 2007-2016 by the Inyoka Team, see AUTHORS for more details.
    :license: BSD, see LICENSE for more details.
#}


{%- extends 'wiki/page.html' %}
{% do BREADCRUMB.append(_('Recent Changes'), '', True) %}
{% set action = 'log' %}
{% block wiki_content %}
  <div class="main_content">
   <h1 class="pagetitle">{% trans %}Recent Changes{% endtrans %}</h1>
   <div id="page">
    {%- if recentchanges %}
    <table class="recent_changes">
     {%- for day in recentchanges.keys() %}
     <tr>
      <th colspan="3">{{ day }}</th>
     </tr>
     {%- for page in recentchanges[day].keys() %}
     <tr>
      <td class="timestamp">
      {{ recentchanges[day][page][-1]['time'] }}
      {%- if recentchanges[day][page]|length > 1 %}
      -
      {{ recentchanges[day][page][0]['time'] }}
      {%- endif %}
      </td>
      <td><a href="{{ href('wiki', page)|e }}">{{ page|e }}</a> (<a href="{{ href('wiki', page, 'a', 'log')|e }}">{{ recentchanges[day][page]|length }}x</a>)</td>
      <td class="note">
       <ul class="note_list">
       {%- for change in recentchanges[day][page] %}
        <li>
       {{ change['note'] }}
       {%- if change['username'] %}
       ( {% trans %}from{% endtrans %} <a href="{{ href('portal', 'user', change['username']|e ) }}">{{ change['username']|e }}</a>)
       {%- endif %}
        </li>
       {%- endfor %}
       </ul>
      </td>
     </tr>
     {%- endfor %}
    {%- endfor %}
    </table>
    {% else %}
    <p>{% trans %}Recent Changes are currently unavailable.{% endtrans %}</p>
    {% endif %}
   </div>
  </div>
{% endblock %}
